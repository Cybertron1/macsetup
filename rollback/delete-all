#!/bin/bash

set -e

sudo -v
WORK_DIR=$(mktemp -d)
cd "$WORK_DIR"
sudo rm -rf /Library/Developer/CommandLineTools
if hash rvm 2>/dev/null; then
  sudo rvm implode
fi

chsh -s /bin/zsh

find ~ ! -name .Trash ! -name .CFUserTextEncoding ! -name .DS_Store -name '.*' -maxdepth 1 -exec rm -rf {} \;

if command -v brew; then
  brew cask uninstall --force $(brew cask list) &>/dev/null || echo "cask remove didn't work"
  curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/uninstall.sh --output uninstall.sh
  sudo /bin/bash ./output.sh -f -q || true
fi

